<div class="container">
    <h1 class="border-bottom py-2 my-3">chart!</h1>
    <div class="row">
        <div class="col-lg-6">
            <div class="row">
                <div class="col">
                    <div class="chart-container" style="position: relative; height:32vh; width:32vw; left: -8vw;">
                        <canvas id="chart-area"></canvas>
                    </div>
                </div>
                <div class="col">
                    <div id="chart-legends"></div>
                </div>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="row">
                <div class="col">
                    <div class="chart-container" style="position: relative; height:32vh; width:32vw; left: -8vw;">
                        <canvas id="chart-area2"></canvas>
                    </div>
                </div>
                <div class="col">
                    <div id="chart-legends2"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"></script>
<script src="https://www.chartjs.org/samples/latest/utils.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        var config = {
            type: 'pie',
            data: {
                datasets: [{
                    data: [
                        3.46,
                        37.63,
                        21.21,
                        12.94,
                        2.47,
                        22.29
                    ],
                    backgroundColor: [
                        window.chartColors.red,
                        window.chartColors.orange,
                        window.chartColors.yellow,
                        window.chartColors.green,
                        window.chartColors.blue,
                        window.chartColors.purple,
                    ],
                    label: 'Dataset 1'
                }],
                labels: [
                    '기부금',
                    '보조금',
                    '사회복지사업수입',
                    '수익사업수입',
                    '기타수입',
                    '이월금',
                ]
            },
            options: {
                responsive: true,
                tooltips: {
                    mode: 'index'
                },
                legend: {
                    position: 'right',
                    display: false,
                },
                legendCallback: function(chart) {
                    var text = [];
                    text.push('<ul class="' + chart.id + '-legend list-unstyled pl-5 mt-4">');
                    var data = chart.data;
                    var datasets = data.datasets;
                    var labels = data.labels;
                    if (datasets.length) {
                        for (var i = 0; i < datasets[0].data.length; ++i) {
                            text.push('<li class="py-2"><span class="d-inline-block badge mr-2 mt-1" style="width: 1rem; height: 1rem; background-color:' + datasets[0].backgroundColor[i] + '"></span>');
                            if (labels[i]) {
                                // calculate percentage
                                var total = datasets[0].data.reduce(function(previousValue, currentValue, currentIndex, array) {
                                    return previousValue + currentValue;
                                });
                                var currentValue = datasets[0].data[i];
                                var percentage = Math.floor(((currentValue / total) * 100) + 0.5);

                                text.push(labels[i] + ' (' + percentage + '%)');
                            }
                            text.push('</li>');
                        }
                    }
                    text.push('</ul>');
                    return text.join('');
                }
            }
        };

        window.onload = function() {
            var ctx = document.getElementById('chart-area').getContext('2d');
            window.myPie = new Chart(ctx, config);
            document.getElementById('chart-legends').innerHTML = window.myPie.generateLegend();

            var ctx = document.getElementById('chart-area2').getContext('2d');
            window.myPie2 = new Chart(ctx, config);
            document.getElementById('chart-legends2').innerHTML = window.myPie2.generateLegend();
        };
    });
</script>